<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @typedef {Object} DashboardConfig
 * @property {String} clientSecret The secret of the Discord Bot
 * @property {String} [redirectURI] The redirect URI for oAuth/signing into the dashboard
 * @property {Number} [port=8080] The port of the dashboard
 * @property {String|Array&lt;String>}
 * @property {Boolean} [maintenanceNotification=false] Whether to send a notification that the bot in under maintenance
 * @property {String} [baseGame=!help | v0.0.6.3] The base game displayed by the bot
 * @property {String} [baseBotStatus=online] The status of the bot. Ex: "online", "offline", "idle", "dnd"
 * @property {String} [maintenanceGame=Bot is in maintenance] The game of the bot when set to "maintenance mode"
 * @property {String} [maintenanceStatus=dnd] The status of the bot when in maintenance. Ex: "online", "offline", "idle", "dnd"
 */

 /**
  * 
  */

/**
 * The Dashboard of the bot.
 * @class
 */
class Dashboard {

    /**
     * 
     * @param {Object} client 
     * @param {DashboardConfig} config 
     * @param {Object} [oAuth]
     */
    constructor (client, config, oAuth) {
        /**
         * See {@link validate}
         */
        validate(client, config);

        /**
         * Disocrd.js Client Object.
         * @type {Object}
         */
        this.client = client;

        /**
         * The config items for the Dashboard.
         * @type {DashboardConfig}
         */
        this.config = {
            //Required Config Items:
            clientSecret: /*oAuth.secret ||*/ config.clientSecret,
            redirectURI: config.redirectURI || CreateRedirectURI(this.port, this.hostName),

            //Not required config items
            port: config.port || 8080,

            maintenanceNotification: config.maintenanceNotification || false,

            baseGame: config.baseGame || "!help | v0.0.6.3",
            baseBotStatus: config.baseBotStatus || "online",

            maintenanceGame: config.maintenanceGame || "Bot is in maintenance",
            maintenanceStatus: config.maintenanceStatus || "dnd",
        };
    }

    /**
     * Used to run the Dashboard.
     * @property {Function} run Used to run the dashbaord and all of the necessary processes
     * @returns {Promise} Promise object.
     * @example
     * //"client" is a constructed Discord.js Client
     * const Dashboard = require("discord-bot-dashboard");
     * 
     * const dashbaord = new Dashboard(client, {
     *      clientSecret: your_client_secrect
     * });
     * 
     * client.on('ready', () => {
     *      dashboard.run();
     * });
     * //...
     */
    run () {
        const client = this.client;
        const config = this.config;

        return new Promise((resolve, reject) => {
            try {
                require('./server').run(client, config); //Runs webserver

                require("./events")(client); //Runs live bot stats using events

                // if (config.enableLogs) {
                //     require("./modules/resourceCheck")(config.logFolderPath); //Runs resource logging for stats in dashbaord
                // }

                resolve();
            } catch (error) {
                reject(error);
            }
        });
    }

    /**
     * Sets better-sqlite3 as the SQLite provider used to store all data
     * @param {Object} db The object that serves as the connection to the database file.
     * @requires better-sqlite3
     * @returns {Promise}
     */
    SQLiteProvider (db) {
        if (!db) throw new Error("Database file not specified for dashboard");
        if (!db.name) throw new Error("Are you sure you are using \"better-sqlite3\" and/or specifed the database file?");

        //...
        //Will handle rest of databse stuff
        return new Promise((resolve, reject) => {
            resolve();
        });
    }
}

/**
 * Used to check the values passed to the Dashboard constructor
 * @param {Object} client Client object from Discord.js
 * @param {Object} config Config object with config items
 * @returns {Void}
 * @private
 */
function validate (client, config) {
    //Check client
    if (!client) throw new Error("Client must be specified");
    if (typeof client !== "object") throw new Error("Client must Client object from Discord.js");

    //Check config type
    if (typeof config !== "object") throw new Error("The config must be an object");

    //Check for and type of required config items
    if (!config.clientSecret) throw new Error("The config item 'clientSecret' must be specified");
    if (typeof config.clientSecret !== "string") throw new Error("The config item 'clientSecret' must be a string");

    //Check datatypes for rest of config items
    if (config.port &amp;&amp; typeof config.port !== "number") throw new TypeError("The config item 'port' must be a number");
    if (config.maintenanceNotification &amp;&amp; typeof config.maintenanceNotification !== "boolean") throw new TypeError("The config item 'maintenanceNotification' must be a boolean");
    if (config.baseGame &amp;&amp; typeof config.baseGame !== "string") throw new TypeError("The config item 'baseGame' must be a string");
    if (config.baseBotStatus &amp;&amp; typeof config.baseBotStatus !== "string") throw new TypeError("The config item 'baseBotStatus' must be a string");
    if (config.maintenanceGame &amp;&amp; typeof config.maintenanceGame !== "string") throw new TypeError("The config item 'maintenanceGame' must be a string");
    if (config.maintenanceStatus &amp;&amp; typeof config.maintenanceStatus !== "string") throw new TypeError("The config item 'maintenanceStatus' must be a string");
    if (config.redirectURI &amp;&amp; typeof config.redirectURI !== "string") throw new TypeError("The config item 'redirectURI' must be a string");

}

/**
 * Used to
 * @param {*} port 
 * @param {*} hostName 
 */
function CreateRedirectURI (port = 8080, hostName = "localhost") {
    return `http://${hostName}:${port}/auth/discord/callback`;
}

/*module.exports = {
    Dashboard,
    CreateRedirectURI
};*/
module.exports = Dashboard
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Dashboard.html">Dashboard</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-getting-started.html">getting-started</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CreateRedirectURI">CreateRedirectURI</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Sat May 02 2020 22:51:00 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
